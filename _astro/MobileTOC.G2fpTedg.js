import{o as wt,i as bt}from"./lifecycle.CmSxJR7h.js";import{e as h,f as K,t as A,a as p,p as gt,b as _t,g as o,m as P,h as v,s as x,i as y,r,c as G,a4 as J}from"./template.dMS9yzsx.js";import{e as q,s as O}from"./render.ASJFz6MC.js";import{i as I}from"./functions.Bd2-gSuy.js";import{e as Q,i as X}from"./each.DZgPpgn4.js";import{a as xt}from"./props.B65lZjQ7.js";import{I as k}from"./Icon.CjLo3ErB.js";import{i as Z}from"./translation.BrPKTDiI.js";import{I as $}from"./zh_TW.Bwnjrhr3.js";/* empty css                        */import"./config.xEVMtnDH.js";function yt(i,T){if(!i||typeof i!="string"){console.warn("navigateToPage: Invalid URL provided");return}if(i.startsWith("http://")||i.startsWith("https://")||i.startsWith("//")){window.open(i,"_blank");return}if(i.startsWith("#")){const u=document.getElementById(i.slice(1));u&&u.scrollIntoView({behavior:"smooth"});return}if(typeof window<"u"&&window.swup)try{T?.replace||window.swup.navigate(i)}catch(u){console.error("Swup navigation failed:",u),tt(i)}else tt(i)}function tt(i,T){window.location.href=i}var It=h('<div class="text-center py-8 text-black/50 dark:text-white/50"><!> <p>暂无文章</p></div>'),kt=h('<div class="post-category svelte-1001a5l"> </div>'),Tt=h('<button class="post-item svelte-1001a5l"><div class="post-title svelte-1001a5l"><!> </div> <!></button>'),Et=h('<div class="post-content svelte-1001a5l"></div>'),Lt=h('<div class="text-center py-8 text-black/50 dark:text-white/50"><!> <p>当前页面没有目录</p></div>'),Ct=h('<button><span class="toc-text svelte-1001a5l"> </span></button>'),St=h('<div class="toc-content svelte-1001a5l"></div>'),At=h(`<button aria-label="Table of Contents" id="mobile-toc-switch" class="btn-plain scale-animation rounded-lg h-11 w-11 active:scale-90 lg:!hidden"><!></button> <div id="mobile-toc-panel" class="float-panel float-panel-closed mobile-toc-panel absolute md:w-[20rem] w-[calc(100vw-2rem)]
		top-20 left-4 md:left-[unset] right-4 shadow-2xl rounded-2xl p-4 svelte-1001a5l"><div class="flex items-center justify-between mb-4"><h3 class="text-lg font-bold text-[var(--primary)]"> </h3> <button aria-label="Close TOC" class="btn-plain rounded-lg h-8 w-8 active:scale-90"><!></button></div> <!></div>`,1);function Kt(i,T){_t(T,!1);let u=P([]),B=P([]),E=P(""),b,L=P(!1),C=!1;const U=()=>{document.getElementById("mobile-toc-panel")?.classList.toggle("float-panel-closed")},Y=t=>{const e=document.getElementById("mobile-toc-panel");e&&e.classList.add("float-panel-closed")},et=()=>{const t=document.querySelectorAll("h1, h2, h3, h4, h5, h6"),e=[];t.forEach(a=>{if(a.id){const l=parseInt(a.tagName.charAt(1)),f=a.textContent?.trim()||"";e.push({id:a.id,text:f,level:l})}}),x(u,e)},ot=()=>{const t=document.querySelectorAll(".card-base"),e=[];t.forEach(a=>{const l=a.querySelector('a[href*="/posts/"].transition.group'),f=a.querySelector('a[href*="/categories/"].link-lg'),n=l?.querySelector('svg[data-icon="mdi:pin"]');if(l){const s=l.getAttribute("href"),m=l.textContent?.replace(/\s+/g," ").trim()||"",c=f?.textContent?.trim()||"",d=!!n;s&&m&&e.push({title:m,url:s,category:c,pinned:d})}}),x(B,e)},st=()=>{x(L,window.location.pathname==="/"||window.location.pathname==="")},at=t=>{const e=document.getElementById(t);if(e){Y();const l=e.offsetTop-80;window.scrollTo({top:l,behavior:"smooth"})}},nt=t=>{Y(),yt(t)},H=()=>{const t=document.querySelectorAll("h1, h2, h3, h4, h5, h6"),e=window.scrollY,a=100;let l="";t.forEach(f=>{if(f.id){const n=f.offsetTop-a;e>=n&&(l=f.id)}}),x(E,l)},it=()=>{const t=document.querySelectorAll("h1, h2, h3, h4, h5, h6");b&&b.disconnect(),b=new IntersectionObserver(e=>{e.forEach(a=>{a.isIntersecting&&x(E,a.target.id)})},{rootMargin:"-80px 0px -80% 0px",threshold:0}),t.forEach(e=>{e.id&&b.observe(e)})},lt=()=>{if(typeof window<"u"&&(C=!!window.swup,!C)){const t=()=>{window.swup&&(C=!0,document.removeEventListener("swup:enable",t))};document.addEventListener("swup:enable",t),setTimeout(()=>{window.swup&&(C=!0,document.removeEventListener("swup:enable",t))},1e3)}},z=()=>{st(),lt(),o(L)?ot():(et(),it(),H())};wt(()=>(setTimeout(z,100),window.addEventListener("scroll",H),()=>{b&&b.disconnect(),window.removeEventListener("scroll",H)})),typeof window<"u"&&(window.mobileTOCInit=z),bt();var D=At(),S=K(D),rt=v(S);k(rt,{icon:"material-symbols:format-list-bulleted",class:"text-[1.25rem]"}),r(S);var F=y(S,2),W=v(F),M=v(W),ct=v(M,!0);r(M);var N=y(M,2),dt=v(N);k(dt,{icon:"material-symbols:close",class:"text-[1rem]"}),r(N),r(W);var vt=y(W,2);{var ft=t=>{var e=G(),a=K(e);{var l=n=>{var s=It(),m=v(s);k(m,{icon:"material-symbols:article-outline",class:"text-2xl mb-2"}),J(2),r(s),p(n,s)},f=n=>{var s=Et();Q(s,5,()=>o(B),X,(m,c)=>{var d=Tt(),g=v(d),_=v(g);{var R=w=>{k(w,{icon:"mdi:pin",class:"pinned-icon"})};I(_,w=>{o(c).pinned&&w(R)})}var V=y(_);r(g);var pt=y(g,2);{var ut=w=>{var j=kt(),ht=v(j,!0);r(j),A(()=>O(ht,o(c).category)),p(w,j)};I(pt,w=>{o(c).category&&w(ut)})}r(d),A(()=>O(V,` ${o(c).title??""}`)),q("click",d,()=>nt(o(c).url)),p(m,d)}),r(s),p(n,s)};I(a,n=>{o(B).length===0?n(l):n(f,!1)})}p(t,e)},mt=t=>{var e=G(),a=K(e);{var l=n=>{var s=Lt(),m=v(s);k(m,{icon:"material-symbols:article-outline",class:"text-2xl mb-2"}),J(2),r(s),p(n,s)},f=n=>{var s=St();Q(s,5,()=>o(u),X,(m,c)=>{var d=Ct();let g;var _=v(d),R=v(_,!0);r(_),r(d),A(V=>{g=xt(d,1,`toc-item level-${o(c).level??""} ${o(E)===o(c).id?"active":""}`,"svelte-1001a5l",g,V),O(R,o(c).text)},[()=>({active:o(E)===o(c).id})]),q("click",d,()=>at(o(c).id)),p(m,d)}),r(s),p(n,s)};I(a,n=>{o(u).length===0?n(l):n(f,!1)})}p(t,e)};I(vt,t=>{o(L)?t(ft):t(mt,!1)})}r(F),A(t=>O(ct,t),[()=>o(L)?Z($.postList):Z($.tableOfContents)]),q("click",S,U),q("click",N,U),p(i,D),gt()}export{Kt as default};
